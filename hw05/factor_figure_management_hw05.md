Factor and Figure management
================
Santiago David
2017-10-20

#### Load data and packages

``` r
suppressPackageStartupMessages(library(tidyverse))
suppressPackageStartupMessages(library(singer))
suppressPackageStartupMessages(library(forcats))
data("singer_locations")
```

Factor management
=================

### Singer version

**Objective 1 Factorise**: Transform some of the variable in the singer\_locations dataframe into factors: pay attention at what levels you introduce and their order. Try and consider the difference between the base R as.factor and the forcats-provided functions

**Process**:

We can start checking at the type of variables in `singer_locations`, and confirm that they are not `factors`

``` r
glimpse(singer_locations)
```

    ## Observations: 10,100
    ## Variables: 14
    ## $ track_id           <chr> "TRWICRA128F42368DB", "TRXJANY128F42246FC",...
    ## $ title              <chr> "The Conversation (Cd)", "Lonely Island", "...
    ## $ song_id            <chr> "SOSURTI12A81C22FB8", "SODESQP12A6D4F98EF",...
    ## $ release            <chr> "Even If It Kills Me", "The Duke Of Earl", ...
    ## $ artist_id          <chr> "ARACDPV1187FB58DF4", "ARYBUAO1187FB3F4EB",...
    ## $ artist_name        <chr> "Motion City Soundtrack", "Gene Chandler", ...
    ## $ year               <int> 2007, 2004, 1998, 1995, 1968, 2006, 2003, 2...
    ## $ duration           <dbl> 170.4485, 106.5530, 527.5947, 695.1179, 237...
    ## $ artist_hotttnesss  <dbl> 0.6410183, 0.3937627, 0.4306226, 0.3622792,...
    ## $ artist_familiarity <dbl> 0.8230522, 0.5700167, 0.5039940, 0.4773099,...
    ## $ latitude           <dbl> NA, 41.88415, 40.71455, NA, 42.33168, 40.99...
    ## $ longitude          <dbl> NA, -87.63241, -74.00712, NA, -83.04792, -7...
    ## $ name               <chr> NA, "Gene Chandler", "Paul Horn", NA, "Doro...
    ## $ city               <chr> NA, "Chicago, IL", "New York, NY", NA, "Det...

Now, I will save the database in a different object and will mutate `artist_name`, `year`, and `city` from character/integer to factor, but keeping the same variable names...

We can do this using Base R function `as.factor`.

``` r
singer_fact <- singer_locations %>% 
  mutate(artist_name = as.factor(artist_name),
         year = as.factor(year),
         city = as.factor(city))
glimpse(singer_fact) # to confirm they are factors now
```

    ## Observations: 10,100
    ## Variables: 14
    ## $ track_id           <chr> "TRWICRA128F42368DB", "TRXJANY128F42246FC",...
    ## $ title              <chr> "The Conversation (Cd)", "Lonely Island", "...
    ## $ song_id            <chr> "SOSURTI12A81C22FB8", "SODESQP12A6D4F98EF",...
    ## $ release            <chr> "Even If It Kills Me", "The Duke Of Earl", ...
    ## $ artist_id          <chr> "ARACDPV1187FB58DF4", "ARYBUAO1187FB3F4EB",...
    ## $ artist_name        <fctr> Motion City Soundtrack, Gene Chandler, Pau...
    ## $ year               <fctr> 2007, 2004, 1998, 1995, 1968, 2006, 2003, ...
    ## $ duration           <dbl> 170.4485, 106.5530, 527.5947, 695.1179, 237...
    ## $ artist_hotttnesss  <dbl> 0.6410183, 0.3937627, 0.4306226, 0.3622792,...
    ## $ artist_familiarity <dbl> 0.8230522, 0.5700167, 0.5039940, 0.4773099,...
    ## $ latitude           <dbl> NA, 41.88415, 40.71455, NA, 42.33168, 40.99...
    ## $ longitude          <dbl> NA, -87.63241, -74.00712, NA, -83.04792, -7...
    ## $ name               <chr> NA, "Gene Chandler", "Paul Horn", NA, "Doro...
    ## $ city               <fctr> NA, Chicago, IL, New York, NY, NA, Detroit...

Or we can also use `as_factor` from the package [forcats](https://www.rdocumentation.org/packages/forcats/versions/0.2.0).

    singer_forcats <- singer_locations %>% 
      mutate(artist_name = as_factor(artist_name),
            year = as_factor(year), 
            city = as_factor(city))

However, there are two problems here, the first one is that `year` is an integer in the original database and can't be converted to factor using `as_factor`, and also `city` have NA's, which is giving an error. The solution I considered was to convert year from integer to character first, and then to factor using `as_factor`. Also, we have to specify an entry value for the missing information in city...

``` r
singer_forcats <- singer_locations %>% 
  mutate(artist_name = as_factor(artist_name),
        year = as.character(year),
        year = as_factor(year), 
        city = ifelse(is.na(city), "missing", city),
        city = as_factor(city), ifelse(is.na(city), "missing", city))

glimpse(singer_forcats)
```

    ## Observations: 10,100
    ## Variables: 15
    ## $ track_id                             <chr> "TRWICRA128F42368DB", "TR...
    ## $ title                                <chr> "The Conversation (Cd)", ...
    ## $ song_id                              <chr> "SOSURTI12A81C22FB8", "SO...
    ## $ release                              <chr> "Even If It Kills Me", "T...
    ## $ artist_id                            <chr> "ARACDPV1187FB58DF4", "AR...
    ## $ artist_name                          <fctr> Motion City Soundtrack, ...
    ## $ year                                 <fctr> 2007, 2004, 1998, 1995, ...
    ## $ duration                             <dbl> 170.4485, 106.5530, 527.5...
    ## $ artist_hotttnesss                    <dbl> 0.6410183, 0.3937627, 0.4...
    ## $ artist_familiarity                   <dbl> 0.8230522, 0.5700167, 0.5...
    ## $ latitude                             <dbl> NA, 41.88415, 40.71455, N...
    ## $ longitude                            <dbl> NA, -87.63241, -74.00712,...
    ## $ name                                 <chr> NA, "Gene Chandler", "Pau...
    ## $ city                                 <fctr> missing, Chicago, IL, Ne...
    ## $ ifelse(is.na(city), "missing", city) <int> 1, 2, 3, 1, 4, 5, 1, 1, 1...

Now, we can see that all three variables are of the type factor, we can also see the difference in the variable city with the two methods, since we assigned a new level called "missing" for the NA's, the second example now includes 1317 levels instead of 1316

``` r
length(levels(singer_fact$city))
```

    ## [1] 1316

``` r
length(levels(singer_forcats$city))
```

    ## [1] 1317

File I/O
========

Visualization design
====================

Writing figures to file
=======================

Clean up your repo!
===================
